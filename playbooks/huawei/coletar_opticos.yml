  name: üîç Coletar Informa√ß√µes do Transceiver (√ìptica) em Switches Huawei
  hosts: huawei_switch
  gather_facts: no
  connection: network_cli
  
  # Vari√°veis de Conex√£o (Ajuste conforme seu ambiente)
  vars:
    ansible_network_os: community.network.cnos # Usado para o tipo de conex√£o VRP
    ansible_user: "AlphaSoares"
    ansible_password: "Soares99RS@"
   ## ansible_become: yes
   ## ansible_become_method: enable # Para entrar em modo privilegiado, se necess√°rio
   ## ansible_become_pass: "sua_senha_enable"
    
  tasks:
   name: Executar 'display interface transceiver verbose'
   ansible.netcommon.cli_command:
        # Este comando exibe todos os transceivers e suas informa√ß√µes detalhadas,
        # incluindo pot√™ncia de transmiss√£o (Tx) e recep√ß√£o (Rx).
        command: display interface transceiver verbose
   register: optical_output # Registra a sa√≠da do comando nesta vari√°vel
      
   name: Salvar a sa√≠da de cada host em um arquivo local
   ansible.builtin.copy:
        content: "{{ optical_output.stdout[0] }}" # A sa√≠da do comando est√° no primeiro elemento da lista stdout
        dest: "./optica_saida/{{ inventory_hostname }}_optica.txt"
      # Cria o diret√≥rio de sa√≠da se ele n√£o existir
      delegate_to: localhost
      run_once: true # Garante que o diret√≥rio de cria√ß√£o de arquivo local s√≥ rode uma vez

   name: Exibir a sa√≠da da √≥ptica no console (Opcional)
   ansible.builtin.debug:
        msg: "Sa√≠da da √≥ptica para {{ inventory_hostname }}:\n{{ optical_output.stdout[0] }}"
