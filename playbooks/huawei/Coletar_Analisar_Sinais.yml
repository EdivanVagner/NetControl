---
- name: ğŸ” Coletar e Analisar Sinais Ã“pticos (Rx) em Switches Huawei
  hosts: 10.0.92.0
  gather_facts: no
  connection: network_cli
  
  # VariÃ¡veis de ConexÃ£o (Ajuste conforme seu ambiente)
  vars:
    ansible_network_os: community.network.cnos
    #ansible_user: "user"
    #ansible_password: "pass"
    
  tasks:
   - name: ğŸ“Š Executar 'display interface transceiver verbose'
     ansible.netcommon.cli_command:
       command: display interface transceiver verbose
     register: optical_output
      
   - name: âœ‚ï¸ Extrair o valor de Rx Power usando Regex
     # Comente ou remova esta task por enquanto
     # ansible.builtin.set_fact:
     #   rx_power_match: "{{ optical_output.stdout[0] | regex_search('Rx Power\\s+:\\s+([-\\d\\.]+)\\s+dBm', '\\1') }}"
      
   - name: ğŸ“‹ Exibir a SAÃDA BRUTA no console
     ansible.builtin.debug:
       # Imprime a saÃ­da completa sem o filtro de Regex
       msg: "SAÃDA BRUTA do {{ inventory_hostname }}:\n{{ optical_output.stdout[0] }}"
