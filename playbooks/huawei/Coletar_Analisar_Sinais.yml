---
- name: ğŸ” Coletar e Analisar Sinais Ã“pticos (Rx) em Switches Huawei
  hosts: 10.0.92.0
  gather_facts: no
  connection: network_cli
  
  # VariÃ¡veis de ConexÃ£o (Ajuste conforme seu ambiente)
  vars:
    ansible_network_os: community.network.cnos
    # Credenciais de conexÃ£o (Devem ser descomentadas ou fornecidas por credenciais AWX)
    # ansible_user: "user" 
    # ansible_password: "pass"
    
  tasks:
    - name: ğŸ“Š Executar 'display interface transceiver verbose'
      ansible.netcommon.cli_command:
        command: display interface transceiver verbose
      register: optical_output
      
    - name: âœ‚ï¸ Extrair o valor de Rx Power usando Regex (DESATIVADO)
      # Esta task estÃ¡ DESATIVADA. Ela nÃ£o causa erro de sintaxe, mas tambÃ©m nÃ£o faz nada.
      # VocÃª deve ativÃ¡-la quando souber o Regex correto.
      # Exemplo de como reativar:
      # ansible.builtin.set_fact:
      #   rx_power_match: "PENDENTE DE REGEX"
      
    - name: ğŸ“‹ Exibir a SAÃDA BRUTA no console
      ansible.builtin.debug:
        # A sintaxe para acessar a saÃ­da do comando Ã© perfeita.
        msg: "SAÃDA BRUTA do {{ inventory_hostname }}:\n{{ optical_output.stdout[0] }}"
